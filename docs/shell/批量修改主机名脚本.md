利用pssh工具批量修改

IP和主机名  
10.1.2.61 mysql  
10.1.2.62 nginx  
10.1.2.63 apache  
10.1.2.71 ansible  
  
创建主机地址和主机名  
centos6  
\#!/bin/bash  
ip1=\`ifconfig \|sed -n '2p' \|awk -F '[: ]+' '{print \$4}'\`  
hostname1=\`cat /etc/sysconfig/network \|grep HOSTNAME \|awk -F'=' '{print
\$2}'\`  
hostname2=\`cat zhujim.txt \|grep \$ip1 \|awk '{print \$2}'\`  
hostname \$hostname2  
sed -i "s/\$hostname1/\$hostname2/g" /etc/sysconfig/network  
hostname  
cat /etc/sysconfig/network  
  
centos7  
\#!/bin/bash  
ip1=\`ifconfig \|sed -n '2p' \|sed 's/\^.\*inet //g' \|sed 's/ net.\*\$//g'\`  
hostname2=\`cat zhujim.txt \|grep \$ip1 \|awk '{print \$2}'\`  
hostnamectl set-hostname --static \$hostname2  
hostname

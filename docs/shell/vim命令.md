https://www.cnblogs.com/yhjoker/p/8405845.html  
  
Vim常用命令记录  
　　(本文仅记录了Vim常用的按键功能和操作，用于备忘和查阅。若为Vim小白，建议先通过列出的参考资源获得对Vim更全面的了解。Vi
是几乎所有Linux发行版都支持的文字编辑工具，也是许多Linux下工具的默认文本编辑工具，而Vim则是其功能加强版。)  
  
vim的模式  
　　Vim一般分为三种不同的模式，普通模式( normal mode )、编辑模式和命令模式.  
　　普通模式( normal mode )  
　　使用vim打开文件则进入普通模式。在普通模式下可通过按键
h、j、k、l来控制光标的移动，通过 x、d(delete) 、 y(yank)
、p(put)等按键可对文本进行操作，在该模式下，键盘按键被视为类似Word下的快捷键的功能，而不是被视为简单的文本输入。  
  
　　编辑模式  
　　在编辑模式下可对文件内容进行编辑。编辑模式下按键输入均被视为文本输入，而不再具备普通模式下的各种功能。用户可以通过按键ESC从编辑模式返回普通模式。  
  
　　命令模式  
　　在普通模式下，键盘输入 ' : '、 ' / '、 ' ?
'则光标移动至界面最下行，并等待进一步输入。之后Vim会根据用户输入执行相应的动作，如保存和退出、查找和替换、执行外部命令等。命令模式下同样通过ESC键返回普通模式。  
  
　文件的打开与保存  
vim filename　　　//打开名为filename的文件  
:w //保存修改至源文件  
:wq //保存修改并退出  
:q! //不保存修改，直接退出  
:w filename //保存修改(选中的部分)至filename(其中filename为不存在重名的新文件)  
  
　　在某些情况下，如当前用户对该文件没有修改权限时(但可以通过权限提升得到更大的权限时)，需要在命令后面加入'
! '，表示强制的意思，但具体能否写入还是由其最终的权限能否修改文件决定的。  
  
　　这里可以看到，输入' : '进入命令模式后，按键 w
即为保存命令，除了可进行文件整体保存外，还可以对特定选中的文本部分进行保存，如何进行文本选择下有介绍。　　　  
　文件编辑  
　　在普通模式下，用户可以借助诸多的功能按键对文件已有的内容进行修改和调整，但想要具体改变和输入新的文本内容，则仍需要进入编辑模式，在编辑模式下除ESC外，其他的按键均被视为正常的按键输入。进入编辑模式可以有多种不同的方式。  
i
//insert即插入模式，从光标所在位置开始插入，即插入的内容位于原光标所在位置字符之前  
I //从光标所在行的行首开始插入  
a
//append即附加模式，从光标所在位置之后附加，即新增内容位于原光标所在位置字符之后  
A //从光标所在行的行末开始附加  
o //在光标所在行的下一行加入新一行  
O //在光标所在行的上一行加入新一行  
R
//进入替换模式，屏幕下方会出现Replace提示，此时的输入会直接替换光标所在位置的字符，与Windows下的
0 作用类似，同样通过ESC键返回  
  
　　用户可以根据不同的需要将光标移动(见下)到合适的位置，再通过对应的功能键进入编辑模式进行文本编辑，编辑完成后，通过ESC键返回普通模式。  
　光标移动(一)  
  
　　k // h -光标左移  
　　h l　　　　　// l -光标右移  
　　j 　　　　　　// j -光标下移(形似向下的箭头)  
// k -光标上移  
　光标移动(二)  
w //移动至下一个单词的第一个字符(即前一个字符为空白字符)  
e //移动至单词的最后一个字符(即后一个字符为空白字符)  
\$ //移动至行尾  
0 //移动至行首  
　光标移动(三)  
　　　上述关于光标移动的按键可以与数字结合使用，解释为重复操作若干次，格式为:
数字 + 移动方式。示例如下:  
3j //下移三格  
4h //左移4格  
2w //移动至第二个单词的词首字符  
3e //移动至第三个单词的词尾字符  
  
　　通过上述的 h、j、k、l和
w、e、\$、0以及上述操作与数字的结合，实现不借助鼠标的快速光标移动。  
  
　其他可用的光标移动  
Ctrl+f 　　//屏幕向下移动一页，相当于PageDown  
Ctrl+b 　　 //屏幕向上移动一页，相当于PageUp  
H　　　　　　　//移动至屏幕中第一行的第一个字符  
M　　　　　　　//移动至屏幕中中间行的第一个字符  
L //移动至屏幕中最低行的第一个字符  
  
　删除操作  
  
x //删除光标所在处的字符(其大写形式X为将光标之前的字符删除，相当于Backspace)  
dd 　//删除光标所在行的操作(常用)  
　　　d即为delete，除了dd外，d指令可与上述光标移动操作结合使用  
dw //删除一个单词  
d3w 　//删除三个单词  
d\$ //删除光标所在处至行尾的字符  
d4l //删除光标所在处起的四个字符  
d2j //删除两行  
　　　同样的，如 2dd 指令则表示将dd指令重复两次，即为删除两行操作，2d2w 则表示将
d2w 操作执行两次，即删除四个单词。  
  
　复制与粘贴  
　　　复制和粘贴借助多个指令的协作完成。包括复制y(yank)，粘贴p(put)和虚拟选择v(visual
selection).  
p
//put命令，将剪贴的内容(注意，既可以是复制的内容，也可以为之前删除的内容)放置在光标后的位置，其大小字母P则表示放置在光标之前的位置  
v //进入虚拟选择模式(visual
selection)，被选择的文本段被高亮显示(v的选择对象为字符，对应的大写字母V则是以行为单位选择)  
　　Ctrl + v　　　　　　　 //以矩形框的形式进行内容选择  
y //复制通过 v 操作选择的文本，或则其本身也可以与光标移动指令一同使用  
//如y5w，则复制5个单词(注意复制是从光标所在处开始的)  
　　复制即通过 v 指令选定文本段，通过 y 指令复制内容，再通过 p
指令将文本放置在指定位置；  
　　剪切即通过 v 指令选定文本段，通过 d (或 x )指令删除内容，再通过 p
指令将文本放置在指定的位置；  
  
　　 p
指令除了用于复制内容的粘贴外，还可以将上一次删除的内容粘贴在指定的位置，故而可以达到类似剪切的效果。对于
v 指令选中的文本，可以进行多种操作，包括复制(y)、删除(x/d)、另存(:w
filename)等，读者完全可以自行进行组合尝试。  
　　指令y和d的指令形式有许多相同之处，除了均有yy和dd这种针对一行内容的处理指令外，指令y可以与光标移动指令相结合，得到更好的使用效果。  
yy //复制光标所在行的内容  
y0 //复制光标所在位置至行首的内容  
y\$ //复制光标所在位置至行尾的内容  
yG //复制光标所在位置至文本结束的内容  
ynG //复制指令与nG指令的结合  
　　　　　　//以及诸如y3w、y3j等指令  
  
　行跳转  
　　通过与 g(goto) 相关的指令实现以行为单位的跳转指令。  
gg //跳转至文件第一行  
G //跳转至文件最后行  
nG //跳转至文件第 n 行  
　　另外，通过快捷键 Ctrl + o
可以返回之前光标所在的位置(是针对gg等行跳转操作而言的上一个位置)。  
  
　撤销操作  
　　与u(undo)相关的指令实现指令撤销  
u //撤销上一次操作  
U //撤销对光标所在行的所有操作  
Ctrl+r 　 //重做上一操作  
  
　替换和修改  
　　文本的替换和修改主要使用替换r(replace)和修改c(change)指令完成。  
rc //其中c为字符，则将光标所在处的字符替换为c  
　　修改指令将指定的范围内的内容删除，并进入编辑模式，从而使得用户可以修改某一部分的文本。指令c与光标移动指令结合使用。用户修改完毕后，需使用ESC返回普通模式。  
ce //删除光标所在处至词尾的所有内容，并进入编辑模式，供用户修改  
c3w 　//删除光标所在处其的三个词，并进入编辑模式  
c\$ //删除光标所在处至行尾的所有字符，并进入编辑模式  
c0 //删除光标所在处至行首的所有字符，并进入编辑模式  
  
　查找  
　　使用 / 与 ？进行不同方向的关键字查找，使用方式与Linux下的man page相似。　  
/keyword //按默认方向查找关键字  
?keyword //按与默认方向相反的方向查找关键字  
n //按与之前相同的查找顺序匹配下一个出现相同关键字的位置  
N //按与之前相反的查找顺序匹配下一个出现相同关键字的位置  
　　　　　　　　　 //用户也可以通过Ctrl + o 和 Ctrl + i 进行位置的切换  
  
　替换  
　　　替换指令可以视为是进入命令模式后借助s(substitute)指令完成。  
  
:s/old/new //将光标所在行出现的第一个old替换为new(仅对该行的第一个old)  
:s/old/new/g 　 // 将光标所在行出现的所有old替换为new  
:s/old/new/gc 　 //同上，替换之前提示用户确认是否替换  
:n,ms/old/new/g　　　//在n和m指定的行之间进行检查和替换  
:%s/old/new/g　　　　//针对整个文本进行替换  
　  
  
　执行命令  
　　通过键入' :
'，使得光标移动至屏幕最下方的行，再键入有效指令，即可由Vim执行。之前介绍的文件的保存和退出、替换等都是这样实现的。Vim支持的命令实际不止于此。  
　　文件保存  
　　之前介绍的文件保存的主要对象是完整的文件，实际上用户也可以借助w(write)指令将部分文本进行保存。  
　　(1)通过 :w filename 将整个文件保存至新建的filename文件中；　　  
　　(2)使用虚拟选择指令v ( V / Ctrl + v )等选中指定文本内容，再通过 :w filename
保存至新建的文件中，则只会保存选中的文本段。这种方式下，屏幕下方的提示符如图所示  
　　(3)通过 :n,m w filename 将文本的n到m行保存至新建文件 filename 中；  
  
　　执行外部指令  
:! command //离开Vim并在终端下执行command指令，结果会直接显示，可通过ESC返回　  
　　文件内容导入　　  
:r filename //将filename指定的文件内容插入至光标所在行的上一行  
:r !command　　//将命令执行的结果插入文本  
  
　修改编辑选项  
　　通过Vim的的set命令(命令模式下，需首先输入 ' : '
)改变编辑器的默认选项。常用的一些选项见下，在对应选项前加入前缀 no
即为取消对应选项。当
\~/.vimrc文件存在时，set的设置则会修改该文件中配置信息，相应的，也可以通过直接修改该配置文件中的内容修改配置(见下)。  
:set nu 　//显示行号，相应的set nonu则为不显示行号  
:set ic 　//搜索忽略大小写(ignore case),取消即为 set noic  
:set hlsearch //搜索时匹配的结果高亮显示  
:set incserch //设置搜索时的搜索顺序  
//可以看到，在对应的选项前面加入前缀no即表示取消取消对应的选项  
:set ruler　　　　//右下角展示状态栏  
:set //显示与系统默认设置不同的参数情况，即被修改过的参数情况  
:set syntax on　 //设置Vim会根据语法以不同颜色显示不同的内容  
:set syntax off  
　　通过命令模式下的set all 命令，可以查看当前所有的vim设置情况。通过命令 help
set 也可以查阅一些关于Vim的设置帮助。  
  
　查看帮助  
　　在命令模式下输入 help
,则会打开一个新的帮助文件，可以通过:q来返回。通过加入参数来查询对应的帮助.  
:help 　　　　　//打开帮助文件  
:help w 　　　　　　//打开指令对应的帮助文件  
:help user-manual  
　　实际上，该命令是通过Vim打开了位于/usr/share/vim中的帮助文档(笔者的机器的路径为/usr/share/vim/vim74/doc)，即相当于使用Vim进行多文件操作。简单的返回方式即为在帮助文档界面键入
:q即可。  
  
　相关文件  
　　配置文件\~/.vimrc  
　　Vim作为一个强大的编辑工具，其本身具有众多的环境参数选项，规定了编辑风格、界面显示等众多的内容。其环境参数的设置主要通过配置文件进行记录。其中位于/etc目录下的配置文件(笔者Ubuntu环境下为/etc/vim/vimrc)规定的是关于Vim的全局设置。而针对个人用户的个性化设置则通过个人用户目录下的～/.vimrc文件完成(不存在时可自行新建)。该文件中
" 符号为注释符号。  
cp /etc/vim/vimrc \~/.vimrc //将源文件复制到用户主目录中  
　　通过在.vim中添加配置信息或取消其中的注释，即可进行vim的配置功能。如去除
syntax on 前的注释从而打开语法高亮等。  
　　记录文件～/.viminfo  
　　文件 \~/.viminfo
记录了用户使用Vim进行的操作情况，多用于类似于指令撤销(u)和重做(r)的操作。  
  
　其他有用的快捷键  
　　(1)通过Ctrl + g 键可以获得文件相关的信息，如文件名，光标所处的行列号等信息；  
　　(2)Ctrl+f
屏幕向下移动一页，相当于PageDown，Ctrl+b屏幕向上移动一页，相当于PageUp按键；  
　　(3)通过 % 键跳转至与之匹配的括号处(包括 {}、[]、()等)；  
　　(4)通过 .　键重复之前一个动作；  
(5)通过Ctrl + d 显示可能匹配的命令，通过Tab 补全指令。命令模式下输入 h
，使用Ctrl + d 键，即会显示出所有的以 h
开头的命令。同样的，对于未完成的命令或文件名，使用Tab键，则Vim会尝试完成输入，当有多个正确的匹配时，按Tab键则会进行切换。  
  
VIM配置文件.vimrc  
[root\@centos6 bin]\# cat /root/.vimrc  
set ignorecase  
set cursorline  
set autoindent  
autocmd BufNewFile \*.sh exec ":call SetTitle()"  
func SetTitle()  
if expand("%:e") == 'sh'  
call setline(1,"\#!/bin/bash")  
call setline(2,"\#")  
call setline(3,"\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#")  
call setline(4,"\#配置说明文件")  
call setline(5,"\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#")  
call setline(6,"\#")  
call setline(7,"")  
endif  
endfunc  
autocmd BufNewFile \* normal G  
  
另外一种  
[root\@centos6 bin]\# cat /root/.vimrc  
"map ms:call WESTOS()'s  
autocmd BufNewFile \*.sh exec ":call WESTOS()"  
func WESTOS ()  
call append(0,"\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#")  
call append(1,"\# Author: xbw".(" \#"))  
call append(2,"\# Version: ".(" \#"))  
call append(3,"\# Mail: ".(" \#"))  
call append(4,"\# Date: ".strftime("%Y-%m-%d").(" \#"))  
call append(5,"\# Description: ".(" \#"))  
call append(6,"\# ".(" \#"))  
call append(7,"\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#")  
call append(8,"")  
call append(9,"\#!/bin/bash")  
endfunc  
  
  
shell脚本的调试  
bash -n \*.sh 检查脚本语法错误  
bash -x \*.sh 跟踪调试脚本

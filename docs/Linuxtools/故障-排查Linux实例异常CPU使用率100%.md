故障-排查 Linux 实例异常 CPU 使用率 100%

检查系统命令修改记录

远程连接并登录到 Linux 实例。

执行以下命令查看系统命令最近是否被修改过。

stat /usr/bin/top

stat /bin/ps

查看系统命令的更改时间，是否和 CPU 使用率出现 100% 的时间点吻合。

执行 rpm 验证是否修改过系统命令。正常情况下，您应该查看不到修改信息。

rpm -Vf /bin/ps

rpm -Vf /usr/bin/top

查看实例的对外连接

执行命令 iftop -i eth1 -n -P 查看当前实例是否连接到异常域名，如示例中的
crypto-pool.fr。

后续操作

经过排查，当实例的 CPU 使用率异常到 100%
时，均符合以上三个特征，基本可以判断您的实例已经中毒，您需要：

尽快备份数据

重装系统
